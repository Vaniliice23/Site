# Инструкция по настройке и запуску портала квитанций зарплаты

## Краткое руководство

Данный документ содержит пошаговые инструкции по настройке и запуску веб-портала для поиска и скачивания квитанций зарплаты из Google Таблиц.

## Шаг 1: Настройка Google Sheets API

1. Перейдите в [Google Cloud Console](https://console.cloud.google.com/)
2. Создайте новый проект (или выберите существующий)
3. В меню слева выберите "APIs & Services" > "Library"
4. Найдите и включите "Google Sheets API"
5. Перейдите в "APIs & Services" > "Credentials"
6. Нажмите "Create Credentials" > "Service Account"
7. Заполните необходимые поля и создайте сервисный аккаунт
8. Нажмите на созданный сервисный аккаунт, перейдите на вкладку "Keys"
9. Нажмите "Add Key" > "Create new key" > выберите формат JSON
10. Скачайте файл ключа и переименуйте его в `credentials.json`

## Шаг 2: Настройка доступа к Google Таблице

1. Откройте вашу Google Таблицу с данными квитанций
2. Нажмите кнопку "Share" (Поделиться) в правом верхнем углу
3. Добавьте email-адрес сервисного аккаунта (он указан в файле credentials.json)
4. Предоставьте права на просмотр (View)
5. Скопируйте ID таблицы из URL (часть между /d/ и /edit)
   Пример: `https://docs.google.com/spreadsheets/d/`**ЭТОТ_ID_НУЖНО_СКОПИРОВАТЬ**`/edit`

## Шаг 3: Настройка приложения

1. Распакуйте архив с приложением
2. Поместите файл `credentials.json` в директорию `src/`
3. Создайте файл `.env` в корневой директории со следующим содержимым:
   ```
   SPREADSHEET_ID=ваш_идентификатор_google_таблицы
   SECRET_KEY=любой_секретный_ключ
   ```
   Замените `ваш_идентификатор_google_таблицы` на ID, скопированный в шаге 2.

## Шаг 4: Запуск приложения

### Windows:
1. Дважды кликните на файл `run.bat`
2. Дождитесь установки зависимостей и запуска сервера
3. Откройте браузер и перейдите по адресу: http://localhost:5000

### Linux/Mac:
1. Откройте терминал в директории с приложением
2. Выполните команду: `chmod +x run.sh`
3. Запустите скрипт: `./run.sh`
4. Откройте браузер и перейдите по адресу: http://localhost:5000

## Шаг 5: Использование приложения

1. На главной странице введите имя и фамилию сотрудника
2. Нажмите кнопку "Найти квитанцию"
3. После успешного поиска вы увидите квитанцию зарплаты
4. Используйте кнопки "Скачать PDF" или "Скачать изображение" для сохранения квитанции

## Шаг 6: Доступ с других устройств в локальной сети

Чтобы сделать портал доступным с других устройств в вашей локальной сети:

1. Узнайте ваш локальный IP-адрес:
   - Windows: выполните команду `ipconfig` в командной строке
   - Linux/Mac: выполните команду `ifconfig` или `ip addr` в терминале
2. На других устройствах в той же сети откройте браузер и введите:
   `http://ваш_локальный_ip:5000`

## Решение проблем

### Ошибка "Файл credentials.json не найден"
- Убедитесь, что файл credentials.json находится в директории src/
- Проверьте правильность имени файла (должно быть именно credentials.json)

### Ошибка "Не удалось подключиться к Google Sheets"
- Проверьте правильность ID таблицы в файле .env
- Убедитесь, что сервисному аккаунту предоставлен доступ к таблице
- Проверьте подключение к интернету

### Квитанция не найдена
- Убедитесь, что имя и фамилия введены точно так, как они указаны в таблице
- Проверьте структуру таблицы (должны быть листы "Контакты" и "Квитанции (Ив-2)")

### Другие проблемы
- Проверьте логи в консоли/терминале
- Убедитесь, что все зависимости установлены корректно
